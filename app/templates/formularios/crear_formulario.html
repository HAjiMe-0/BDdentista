{% extends 'base.html' %}

{% block title %}Dashboard - Bienvenido {% endblock %}

{% block content %}

<style>
:root {
    --color-white: #ffffff;
    --color-primary: #5CCDC9;  
    --color-primary-dark: #45A29E;
    --color-secondary: #77E0DC;
    --color-light: #E5F6F5;
    --color-gray: #6C757D;
    --gradient-primary:var(--color-primary-dark);
    --background-image: url("/static/img/fondo_dental7.jpg");
}

body {
    background-color: var(--color-light);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-image: var(--background-image);
    background-repeat: no-repeat;
    background-position: center;
    background-size: cover;
    background-attachment: fixed;
    min-height: 100vh;
    margin: 0;
    padding: 0;
}

.custom-container {
    max-width: 1000px;
    margin: 2rem auto;
    background-color: var(--color-white);
    border-radius: 20px;
    padding: 0; /* Removemos el padding del contenedor */
}

.page-title {
    color: var(--color-white);
    font-size: 1.8rem;
    font-weight: 500;
    text-align: center;
    margin: 0;
    padding: 1.5rem;
    background: var(--gradient-primary);
    border-radius: 20px 20px 0 0;
    border-bottom: none;
}

.form-container {
    padding: 1rem; /* Reduce el padding del contenedor */
}

.card {
    border: none;
    border-radius: 15px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    margin-bottom: 2rem;
}
.row.mb-3 {
    margin-bottom: 0.5rem !important; /* Reduce el espacio entre filas */
}
.col-form-label {
    padding-top: 0.25rem !important;
    padding-bottom: 0.25rem !important;
}
.custom-card-header {
    background: var(--gradient-primary);
    color: var(--color-white);
    border-radius: 15px 15px 0 0 !important;
    padding: 1rem 1.5rem;
    font-weight: 500;
    font-size: 1.1rem;
}
.custom-container h3 {
    margin: 0.5rem 0;
    padding: 0.5rem 0;
}

.card-body {
    padding: 1rem 1.5rem; /* Reduce el padding vertical del card-body */
}

.form-control {
    border: 2px solid var(--color-light);
    border-radius: 10px;
    padding: 0.75rem 1rem;
    transition: all 0.3s ease;
}

.form-control:focus {
    border-color: var(--color-primary);
    box-shadow: 0 0 0 0.2rem rgba(92, 205, 201, 0.25);
}

.form-label {
    color: var(--color-primary-dark);
    font-weight: 500;
    margin-bottom: 0.5rem;
}

.accordion-button {
    background: var(--color-light) !important;
    color: var(--color-primary-dark) !important;
    font-weight: 500;
    border: none;
    padding: 1rem 1.5rem;
}

.accordion-button:not(.collapsed) {
    background: var(--color-primary-dark) !important;
    color: var(--color-white) !important;
}

.accordion-item {
    border: none;
    border-radius: 15px;
    margin-bottom: 1rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

.form-check-input {
    width: 1.2rem;
    height: 1.2rem;
    margin-top: 0.25rem;
}

.form-check-input:checked {
    background-color: var(--color-primary);
    border-color: var(--color-primary);
}

.form-check-label {
    padding-left: 0.5rem;
    color: var(--color-gray);
}

.btn-custom-primary {
    background: var(--gradient-primary);
    border: none;
    color: var(--color-white);
    padding: 0.75rem 2rem;
    border-radius: 10px;
    font-weight: 500;
    transition: all 0.3s ease;
}

.btn-custom-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(92, 205, 201, 0.3);
}

.btn-secondary {
    background: var(--color-light);
    border: none;
    color: var(--color-primary-dark);
    padding: 0.75rem 2rem;
    border-radius: 10px;
    font-weight: 500;
    transition: all 0.3s ease;
}

.btn-secondary:hover {
    background: var(--color-secondary);
    color: var(--color-white);
    transform: translateY(-2px);
}
.accordion-body {
    padding: 1.5rem;
}

.two-column-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1.5rem;
}
.col-sm-8 span {
    line-height: 1.2;
}
@media (max-width: 768px) {
    .two-column-grid {
        grid-template-columns: 1fr;
    }
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .custom-container {
        margin: 1rem;
        padding: 1rem;
    }
    
    .page-title {
        font-size: 1.5rem;
    }
    
    .btn-custom-primary,
    .btn-secondary {
        width: 100%;
        margin-bottom: 0.5rem;
    }
}

</style>

<div class="container custom-container mt-5">
    <h2 class="text-center page-title" style="font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; ">Formulario de Historial Clínico</h2>
    <form id="formularioClinico" class="needs-validation" novalidate>
        <input type="hidden" id="paciente_id" value="{{ paciente.paciente_id }}">
        <!-- Información básica más compacta -->
        <div class="card mb-4">
            <div style="color: #45A29E;text-align: center;"><h3>Información Básica del Paciente</h3></div>
            <div class="card-body">
                <div class="row mb-3">
                    <label class="col-sm-4 col-form-label" style="color: #45A29E;"><strong>Nombre completo:</strong></label>
                    <div class="col-sm-8">
                        <span>{{paciente.nombre}} {{paciente.paterno}} {{paciente.materno}}</span>
                    </div>
                </div>
                <div class="row mb-3">
                    <label class="col-sm-4 col-form-label" style="color: #45A29E;"><strong>Cédula de Identidad:</strong></label>
                    <div class="col-sm-8">
                        <span>{{paciente.ci}}</span>
                    </div>
                </div>
                <div class="row mb-3">
                    <label class="col-sm-4 col-form-label" style="color: #45A29E;"><strong>Fecha de nacimiento:</strong></label>
                    <div class="col-sm-8">
                        <span>{{paciente.fecha_nacimiento}}</span>
                    </div>
                </div>
                <div class="row mb-3">
                    <label class="col-sm-4 col-form-label" style="color: #45A29E;"><strong>Estado civil:</strong></label>
                    <div class="col-sm-8">
                        <span>{{paciente.estado_civil}}</span>
                    </div>
                </div>
                <div class="row mb-3">
                    <label class="col-sm-4 col-form-label" style="color: #45A29E;"><strong>Ocupación:</strong></label>
                    <div class="col-sm-8">
                        <span>{{paciente.ocupacion}}</span>
                    </div>
                </div>
                <div class="row mb-3">
                    <label class="col-sm-4 col-form-label" style="color: #45A29E;"><strong>Dirección:</strong></label>
                    <div class="col-sm-8">
                        <span>{{paciente.direccion}}</span>
                    </div>
                </div>
                <div class="row mb-3">
                    <label class="col-sm-4 col-form-label" style="color: #45A29E;"><strong>Teléfono fijo:</strong></label>
                    <div class="col-sm-8">
                        <span>{{paciente.telefono}}</span>
                    </div>
                </div>
                <div class="row">
                    <label class="col-sm-4 col-form-label" style="color: #45A29E;"><strong>Celular:</strong></label>
                    <div class="col-sm-8">
                        <span>{{paciente.celular}}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Antecedentes Médicos reorganizados -->
        <div class="accordion mb-4" id="antecedentesAccordion">
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAntecedentes" aria-expanded="true">
                        Antecedentes Médicos
                    </button>
                </h2>
                <div id="collapseAntecedentes" class="accordion-collapse collapse show">
                    <div class="accordion-body">
                        <div class="two-column-grid">
                            <!-- Columna 1 - Historial General -->
                            <div>
                                <!-- 1. Operaciones previas -->
                                <div class="mb-3">
                                    <label for="operaciones" class="form-label">1. ¿Ha tenido alguna operación o enfermedad grave?</label>
                                    <input type="text" class="form-control" name="operaciones" id="operaciones" >
                                </div>

                                <!-- 2. Enfermedades diagnosticadas -->
                                <div class="mb-3">
                                    <label for="enfermedades" class="form-label">2. ¿Ha sido diagnosticado con alguna de las siguientes condiciones?</label>
                                    <!-- Enfermedades cardiovasculares -->
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="enfermedades[]" value="Presión alta" id="presionAlta">
                                        <label class="form-check-label" for="presionAlta">Presión alta</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="enfermedades[]" value="Presión baja" id="presionBaja">
                                        <label class="form-check-label" for="presionBaja">Presión baja</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="enfermedades[]" value="Cardiopatía" id="cardiopatia">
                                        <label class="form-check-label" for="cardiopatia">Cardiopatía</label>
                                    </div>
                                    <div class="mb-3" id="detalleCardiopatiaDiv" style="display: none;">
                                        <label for="detalle_cardiopatia" class="form-label">Detalle Cardiopatía:</label>
                                        <textarea class="form-control" id="detalle_cardiopatia" name="detalle_cardiopatia"></textarea>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="enfermedades[]" value="Fiebre reumática" id="fiebreReumatica">
                                        <label class="form-check-label" for="fiebreReumatica">Fiebre reumática</label>
                                    </div>
                                    <!-- Enfermedades respiratorias -->
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="enfermedades[]" value="Enfermedades Respiratorias" id="enfermedadesRespiratorias">
                                        <label class="form-check-label" for="enfermedadesRespiratorias">Enfermedades respiratorias</label>
                                    </div>
                                    <div class="mb-3" id="detalleRespiratoriasDiv" style="display: none;">
                                        <label for="detalle_respiratorias" class="form-label">Especifique:</label>
                                        <textarea class="form-control" id="detalle_respiratorias" name="detalle_respiratorias"></textarea>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="enfermedades[]" value="Asma" id="asma">
                                        <label class="form-check-label" for="asma">Asma</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="enfermedades[]" value="Sinusitis" id="sinusitis">
                                        <label class="form-check-label" for="sinusitis">Sinusitis</label>
                                    </div>
                                    <!-- Enfermedades sistémicas -->
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="enfermedades[]" value="Diabetes" id="diabetes">
                                        <label class="form-check-label" for="diabetes">Diabetes</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="enfermedades[]" value="Artritis" id="artritis">
                                        <label class="form-check-label" for="artritis">Artritis</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="enfermedades[]" value="Enfermedades Renales" id="enfermedadesrenales">
                                        <label class="form-check-label" for="enfermedadesrenales">Enfermedades Renales</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="enfermedades[]" value="Hepatitis" id="hepatitis">
                                        <label class="form-check-label" for="hepatitis">Hepatitis</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="enfermedades[]" value="Úlcera gástrica" id="ulceraGastrica">
                                        <label class="form-check-label" for="ulceraGastrica">Úlcera gástrica</label>
                                    </div>
                                    <!-- Enfermedades infecciosas -->
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="enfermedades[]" value="Tuberculosis" id="tuberculosis">
                                        <label class="form-check-label" for="tuberculosis">Tuberculosis</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="enfermedades[]" value="Enfermedades venéreas" id="enfermedadesVeneras">
                                        <label class="form-check-label" for="enfermedadesVeneras">Enfermedades venéreas</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="enfermedades[]" value="VIH(SIDA)" id="vihSida">
                                        <label class="form-check-label" for="vihSida">VIH(SIDA)</label>
                                    </div>
                                    <!-- Otros síntomas -->
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="enfermedades[]" value="Mareos" id="mareos">
                                        <label class="form-check-label" for="mareos">Mareos</label>
                                    </div>
                                </div>
                                <!-- Alergias -->
                                <div class="mb-3">
                                    <label class="form-label">3. ¿Tiene alergias?</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="alergias_opcion" value="Sí" id="alergiasSi" onclick="mostrarEspecificarAlergias(true)">
                                        <label class="form-check-label" for="alergiasSi">Sí</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="alergias_opcion" value="No" id="alergiasNo" onclick="mostrarEspecificarAlergias(false)">
                                        <label class="form-check-label" for="alergiasNo">No</label>
                                    </div>
                                    <div id="campoEspecificarAlergias" style="display: none; margin-top: 10px;">
                                        <label class="form-label">Especifique las alergias:</label>
                                        <input class="form-control" type="text" name="alergias" id="alergias" placeholder="Describa sus alergias">
                                    </div>
                                </div>
                                <!-- Síntomas cardiorrespiratorios -->
                                <div class="mb-3">
                                    <label class="form-label">4. ¿Siente dolor en el tórax después de hacer ejercicio?</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="dolor_torax" value="Sí" id="dolorToraxSi">
                                        <label class="form-check-label" for="dolorToraxSi">Sí</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="dolor_torax" value="No" id="dolorToraxNo">
                                        <label class="form-check-label" for="dolorToraxNo">No</label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">5. ¿Le falta aire después del ejercicio?</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="falta_aire" value="Sí" id="faltaAireSi">
                                        <label class="form-check-label" for="faltaAireSi">Sí</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="falta_aire" value="No" id="faltaAireNo">
                                        <label class="form-check-label" for="faltaAireNo">No</label>
                                    </div>
                                </div>
                                <!-- Antecedentes odontológicos -->
                                <div class="mb-3">
                                    <label class="form-label">6. ¿Ha sangrado de forma anormal después de una extracción?</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="sangrado_anormal" value="Sí" id="sangradoAnormalSi">
                                        <label class="form-check-label" for="sangradoAnormalSi">Sí</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="sangrado_anormal" value="No" id="sangradoAnormalNo">
                                        <label class="form-check-label" for="sangradoAnormalNo">No</label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="problema_odontologico" class="form-label">7. ¿Ha tenido algún problema grave asociado con algún tratamiento odontológico?</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="problema_opcion" value="Sí" id="problemaSi" onclick="mostrarEspecificarProblema(true)">
                                        <label class="form-check-label" for="problemaSi">Sí</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="problema_opcion" value="No" id="problemaNo" onclick="mostrarEspecificarProblema(false)">
                                        <label class="form-check-label" for="problemaNo">No</label>
                                    </div>
                                    <div id="campoEspecificarProblema" style="display: none; margin-top: 10px;">
                                        <label class="form-label">Especifique problema:</label>
                                        <input class="form-control" type="text" name="problema_odontologico" id="problema_odontologico" placeholder="Especifique problema:">
                                    </div>
                                </div>
                            </div>

                            <!-- Columna 2 - Preguntas específicas -->
                            <div>
                                <div class="mb-3">
                                    <label class="form-label">8. ¿Ha tenido alguna enfermedad, proceso o problema no relacionado con la odontología?</label>
                                    <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="problema_no_odontologico" value="Sí" id="problemaNoOdontologicoSi">
                                    <label class="form-check-label" for="problemaNoOdontologicoSi">Sí</label>
                                    </div>
                                    <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="problema_no_odontologico" value="No" id="problemaNoOdontologicoNo">
                                    <label class="form-check-label" for="problemaNoOdontologicoNo">No</label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">9. ¿Está tomando algún tipo de medicamento o fármaco?</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="medicamento" value="Sí" id="medicamentoSi">
                                        <label class="form-check-label" for="medicamentoSi">Sí</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="medicamento" value="No" id="medicamentoNo">
                                        <label class="form-check-label" for="medicamentoNo">No</label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">10. ¿Ha tenido reacciones adversas a medicamentos?</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="reacciones_medicamentos" value="Sí" id="reaccionesMedicamentosSi">
                                        <label class="form-check-label" for="reaccionesMedicamentosSi">Sí</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="reacciones_medicamentos" value="No" id="reaccionesMedicamentosNo">
                                        <label class="form-check-label" for="reaccionesMedicamentosNo">No</label>
                                    </div>
                                    <label for="detalleReaccionesMedicamentos" class="form-label mt-2">¿Cuál?</label>
                                    <input type="text" class="form-control" name="detalle_reacciones_medicamentos" id="detalleReaccionesMedicamentos">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">11. Acostumbra:</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="costumbres[]" value="Fumar" id="costumbreFumar">
                                        <label class="form-check-label" for="costumbreFumar">Fumar</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="costumbres[]" value="Beber" id="costumbreBeber">
                                        <label class="form-check-label" for="costumbreBeber">Beber</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="costumbres[]" value="Rechinar los dientes" id="costumbreRechinar">
                                        <label class="form-check-label" for="costumbreRechinar">Rechinar los dientes</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="costumbres[]" value="Roncar" id="costumbreRoncar">
                                        <label class="form-check-label" for="costumbreRoncar">Roncar</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="costumbres[]" value="Respirar por la boca" id="costumbreRespirar">
                                        <label class="form-check-label" for="costumbreRespirar">Respirar por la boca</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="costumbres[]" value="Morderse los labios o la lengua" id="costumbreMorderse">
                                        <label class="form-check-label" for="costumbreMorderse">Morderse los labios o la lengua</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="costumbres[]" value="Chuparse el dedo" id="costumbreChuparse">
                                        <label class="form-check-label" for="costumbreChuparse">Chuparse el dedo</label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">12. ¿Tiene algún problema con:</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="problemas[]" value="Riñones" id="problemasRinones">
                                        <label class="form-check-label" for="problemasRinones">Riñones</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="problemas[]" value="Pulmones" id="problemasPulmones">
                                        <label class="form-check-label" for="problemasPulmones">Pulmones</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="problemas[]" value="Hígado" id="problemasHigado">
                                        <label class="form-check-label" for="problemasHigado">Hígado</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="problemas[]" value="Articulaciones" id="problemasArticulaciones">
                                        <label class="form-check-label" for="problemasArticulaciones">Articulaciones</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="problemas[]" value="Otros" id="problemasOtros">
                                        <label class="form-check-label" for="problemasOtros">Otros</label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">13. ¿Ud. ha tenido en los últimos 14 días:</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="ultimos_14[]" value="Problemas respiratorios" id="ultimos14Respiratorios">
                                        <label class="form-check-label" for="ultimos14Respiratorios">Problemas respiratorios</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="ultimos_14[]" value="Fiebre" id="ultimos14Fiebre">
                                        <label class="form-check-label" for="ultimos14Fiebre">Fiebre</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="ultimos_14[]" value="Dolor muscular" id="ultimos14Dolor">
                                        <label class="form-check-label" for="ultimos14Dolor">Dolor muscular</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="ultimos_14[]" value="Contacto con pacientes COVID-19" id="ultimos14Contacto">
                                        <label class="form-check-label" for="ultimos14Contacto">Contacto con pacientes COVID-19</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="ultimos_14[]" value="Viajes a lugares de riesgo COVID-19" id="ultimos14Viajes">
                                        <label class="form-check-label" for="ultimos14Viajes">Viajes a lugares de riesgo COVID-19</label>
                                    </div>
                                </div>  
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Exclusivo para mujeres -->
        <div class="accordion mb-4" id="exclusivoMujeresAccordion">
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseMujeres" aria-expanded="true">
                        Exclusivo para mujeres
                    </button>
                </h2>
                <div id="collapseMujeres" class="accordion-collapse collapse show">
                    <div class="accordion-body">
                        <div class="two-column-grid">
                            <!-- Column 1 -->
                            <div>
                                <div class="mb-3">
                                    <label class="form-label">13. ¿Está usted embarazada?</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="embarazo" value="Sí" id="embarazoSi">
                                        <label class="form-check-label" for="embarazoSi">Sí</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="embarazo" value="No" id="embarazoNo">
                                        <label class="form-check-label" for="embarazoNo">No</label>
                                    </div>
                                    <label for="semanasEmbarazo" class="form-label mt-2">¿Cuántas semanas?</label>
                                    <input type="number" class="form-control" name="semanas_embarazo" id="semanasEmbarazo" placeholder="Si aplica">
                                </div>
                            </div>
                            
                            <!-- Column 2 -->
                            <div>
                                <div class="mb-3">
                                    <label for="observaciones" class="form-label">14. Observaciones</label>
                                    <textarea class="form-control" name="observaciones" id="observaciones"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Declaración -->
        <div class="card mb-4">
            <div class="card-header custom-card-header">Declaración</div>
            <div class="card-body">
                <p>El paciente declara haber entendido todas las explicaciones...</p>
            </div>
        </div>

        <!-- Botones -->
        <div class="d-flex justify-content-end gap-2">
            <button type="button" class="btn btn-custom-primary" onclick="guardarFormulario()">Guardar</button>
            <a href="{{ url_for('main.listar_formulario', paciente_id=paciente_id) }}" class="btn btn-secondary">Volver</a>
        </div>
    </form>
</div>

<script>
    async function guardarFormulario() {
        const pacienteId = document.getElementById('paciente_id').value;
        const form = document.getElementById('formularioClinico');
        const formData = new FormData(form);

        const preguntaRespuesta = {};
        formData.forEach((value, key) => {
            if (preguntaRespuesta[key]) {
                if (!Array.isArray(preguntaRespuesta[key])) {
                    preguntaRespuesta[key] = [preguntaRespuesta[key]];
                }
                preguntaRespuesta[key].push(value);
            } else {
                preguntaRespuesta[key] = value;
            }
        });

        const data = {
            paciente_id: pacienteId,
            pregunta_respuesta: preguntaRespuesta
        };

        try {
            const response = await fetch('/guardar_historial', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            const result = await response.json();
            alert(result.message);
        } catch (error) {
            console.error("Error al guardar el formulario:", error);
            alert('Error al guardar el historial.');
        }
    }
</script>
<script>
    // Mostrar detalles de Cardiopatía cuando el checkbox sea marcado
    document.getElementById("cardiopatia").addEventListener("change", function() {
        var detalleCardiopatiaDiv = document.getElementById("detalleCardiopatiaDiv");
        if (this.checked) {
            detalleCardiopatiaDiv.style.display = "block";
        } else {
            detalleCardiopatiaDiv.style.display = "none";
        }
    });

    // Mostrar detalles de Enfermedades Respiratorias cuando el checkbox sea marcado
    document.getElementById("enfermedadesRespiratorias").addEventListener("change", function() {
        var detalleRespiratoriasDiv = document.getElementById("detalleRespiratoriasDiv");
        if (this.checked) {
            detalleRespiratoriasDiv.style.display = "block";
        } else {
            detalleRespiratoriasDiv.style.display = "none";
        }
    });
</script>
<script>
    function mostrarEspecificarAlergias(mostrar) {
        const campo = document.getElementById('campoEspecificarAlergias');
        if (mostrar) {
            campo.style.display = 'block';
        } else {
            campo.style.display = 'none';
            document.getElementById('alergias').value = ''; // Limpiar el campo si se selecciona "No"
        }
    }
</script>
<script>
    function mostrarEspecificarProblema(mostrar) {
        const campo = document.getElementById('campoEspecificarProblema');
        if (mostrar) {
            campo.style.display = 'block';
        } else {
            campo.style.display = 'none';
            document.getElementById('problema_odontologico').value = ''; // Limpiar el campo si se selecciona "No"
        }
    }
</script>


{% endblock %}